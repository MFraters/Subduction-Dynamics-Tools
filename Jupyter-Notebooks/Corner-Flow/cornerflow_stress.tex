
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
     \usepackage{natbib}    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Corner Flow Shear Stress, Streamlines and Flow Field}
    
    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{analytic-corner-flow-solution-for-a-rigid-dipping-slab}{%
\section{Analytic Corner Flow Solution for a Rigid Dipping
Slab}\label{analytic-corner-flow-solution-for-a-rigid-dipping-slab}}

This notebook presents the calculation of the stress, stream function
and velocity generated by a rigid dipping slab moving at a fixed
velocity in a semi-infinite isoviscous fluid. The original solution is
found in \textit{Introduction to Fluid Dynamics} by \citet{batchelor_book67}. In 1969,
Dan McKenzie used these equations to model the flow in the mantle driven
by a sinking slab in his paper, \textit{On the Causes and Consequences of Plate
Tectonics} \citep{mckenzie_gjras69}. Later, in a paper titled \textit{Angle of Subduction} this analytic
model for flow induced by the slab was used to argue that the average
dip of slabs is determined by a balance between the weigh of the slab
and flow-induced pressure on the slab \citep{stevenson_turner_nature77}.\\
\ \\
\noindent Professor Magali I. Billen\\
Department of Earth and Planetary Sciences\\
UC Davis \\
February 15, 2018

    \hypertarget{corner-flow-calculation-of-constants}{%
\subsubsection{Corner Flow Calculation of
Constants}\label{corner-flow-calculation-of-constants}}

It is important to note that the geometry (and thus boundary conditions)
used to find the solutions are different in \citet{batchelor_book67} and
\citet{mckenzie_gjras69}. You can not mix the two, you must choose one geometry
and solve for the constants with the appropriate boundary conditions.

I am writing this all out here because I don't want to ever have to
re-do this solution by hand (I've done it at least 5 separate times
since I was a graduate student\ldots{} that seems like enough).

I have included the relevant parts of \citet{mckenzie_gjras69} at the end of this
notebook. Figure 5 shows the geometry. Note, the mantle wedge is region
B and the sub-slab is region A. As this is drawn, the positive x axis is
at point c, origin at b and negative x axis at point a. The y-axis is
positive downwards. Also, note that the angles are measured in opposite
directions (\(\theta_b\) is counter clockwise, \(\theta_a\) is
clockwise), and \(\theta\) is also measured in opposite directions in
the two different regions(this is important for applying the boundary
conditions).

The solution to the flow (conservation of mass and momentum subject to
incompressibility) is found by expressing the velocity in terms of a
stream function:
\[ v = (v_z, \frac{1}{r}\frac{d\psi}{d\theta}, -\frac{d\psi}{dr})\]
Assuming \(v_z=0\) everywhere, then the PDE for the flow, becomes
\(\nabla^4\psi=0\). Defining, \(\psi = rf(\theta)\) and substituting,
the PDE becomes:
\[\frac{d^4f}{d\theta^4} + 2\frac{d^2f}{d\theta^2} + f = 0\] The
solution to this PDE is:
\[ f(\theta) = A\sin\theta + B\cos\theta + C\theta\sin\theta + D\theta\cos\theta\]
Note that this means that \[v_r = \frac{df}{d\theta}\] and
\[v_{\theta} = - f(\theta)\] and
\[\frac{df}{d\theta} = A\cos\theta -B\sin\theta + C(\sin\theta + \theta\cos\theta) + D(\cos\theta - \theta\sin\theta)\]
The geometry and boundary conditions are then used to find the constants
A, B, C, and D.

For the geometry defined above, the boundary conditions in region A are:

on \(\theta = 0\), \(v_r = -v\) and \(v_{\theta} = 0\)

on \(\theta = \theta_a\), \(v_r = v\) and \(v_{\theta} = 0\)

In region B:

on \(\theta = 0\), \(v_r = 0\) and \(v_{\theta} = 0\)

on \(\theta = \theta_b\), \(v_r = v\) and \(v_{\theta} = 0\)

The constants found using these boundary conditions in region A are:

\(A = \frac{-v\theta_a}{\sin\theta_a + \theta_a}\)

\(B = 0\)

\(C = \frac{v(1+\cos\theta_a) }{\sin\theta_a + \theta_a}\)

\(D = \frac{-v\sin\theta_a }{\sin\theta_a + \theta_a}\)

and in region B:

\(A = \frac{v \theta_b sin\theta_b}{\theta_b^2 - \sin^2\theta_b}\)

\(B = 0\)

\(C = \frac{-v (\sin\theta_b - \theta_b\cos\theta_b) }{\theta_b^2 - \sin^2\theta_b}\)

\(D = \frac{-v \theta_b sin\theta_b}{\theta_b^2 - \sin^2\theta_b}\)

These constants have been check against the equations for the stream
function given in \citet{mckenzie_gjras69}.

The shear stresses are given by

\(\sigma_{r\theta} = \frac{2\eta}{r}(C\cos\theta - D\sin\theta)\)

I have also checked this against the stress equations in \citet{mckenzie_gjras69}. 
Note, there is a typo in equation 3.17, the term
\(\cos(\theta_a)\) in the numerator should be \(\cos(\theta)\). This is
correct in the pressure equations given by \citet{stevenson_turner_nature77}. 
The solution has also been check against the figure in \citet{mckenzie_gjras69}.

Finally, the dynamic (flow-induced) pressure in the mantle is just the
shear stress (\(P=\sigma_{r\theta}\), because
\(\sigma_{rr} = \sigma_{\theta\theta} = 0\). The pressure is used in the
paper by \citet{stevenson_turner_nature77} to estimate the
steady-state dip of slabs.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         
         \PY{c+c1}{\PYZsh{} Plot on a figure}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.autolayout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.labelsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{12}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.titlesize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{14}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{16}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines.linewidth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mf}{2.0}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines.markersize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{8}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{legend.fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{12}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text.usetex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.family}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serif}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cm}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{} Conversion constants}
         \PY{n}{d2r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{180}
         \PY{n}{sec2yr} \PY{o}{=} \PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{24}\PY{o}{*}\PY{l+m+mi}{365}  \PY{c+c1}{\PYZsh{} sec to yr}
         \PY{n}{pa2bar} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}5}
         
         \PY{c+c1}{\PYZsh{} Parameters that need to be defined for each slab}
         \PY{n}{dip} \PY{o}{=} \PY{l+m+mi}{45}  \PY{c+c1}{\PYZsh{} degrees}
         \PY{n}{vslabcmyr} \PY{o}{=} \PY{l+m+mi}{5} \PY{c+c1}{\PYZsh{} cm/yr}
         \PY{n}{etaslabm} \PY{o}{=} \PY{l+m+mf}{1e20}  \PY{c+c1}{\PYZsh{} Pa s}
         
         \PY{n}{vslab} \PY{o}{=} \PY{n}{vslabcmyr}\PY{o}{/}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{sec2yr}  \PY{c+c1}{\PYZsh{} m/s}
         
         \PY{c+c1}{\PYZsh{} Set up geometry}
         \PY{n}{thb} \PY{o}{=} \PY{n}{dip}\PY{o}{*}\PY{n}{d2r} \PY{c+c1}{\PYZsh{} Region B (mantle wedge above slab)}
         \PY{n}{tha} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{180}\PY{o}{\PYZhy{}}\PY{n}{dip}\PY{p}{)}\PY{o}{*}\PY{n}{d2r}  \PY{c+c1}{\PYZsh{} Regiona A (below slab)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{thb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{thb}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tha}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{tha}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Set\PYZhy{}up Mesh}
         \PY{n}{dx} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{;} \PY{c+c1}{\PYZsh{} km}
         
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{400}\PY{p}{,}\PY{l+m+mi}{200}\PY{o}{+}\PY{n}{dx}\PY{p}{,}\PY{n}{dx}\PY{p}{)} \PY{c+c1}{\PYZsh{} km}
         \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{300}\PY{o}{+}\PY{n}{dx}\PY{p}{,}\PY{n}{dx}\PY{p}{)} \PY{c+c1}{\PYZsh{} km}
         \PY{p}{[}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{y}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Convert to Polar coordinates}
         \PY{n}{R} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{Y}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{1000}  \PY{c+c1}{\PYZsh{} meters, same for region A and B}
         \PY{n}{TH} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arccos}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{X}\PY{o}{/}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{X}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{Y}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} for region B with negative X values}
         \PY{n}{THM} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{\PYZhy{}} \PY{n}{TH} \PY{c+c1}{\PYZsh{} for region A with positive X values reverse theta.}
         
         \PY{c+c1}{\PYZsh{} Indices defining the two regions}
         \PY{n}{pb} \PY{o}{=} \PY{p}{(}\PY{n}{TH}\PY{o}{\PYZlt{}}\PY{n}{thb}\PY{p}{)}\PY{o}{.}\PY{n}{nonzero}\PY{p}{(}\PY{p}{)}
         \PY{n}{pa} \PY{o}{=} \PY{p}{(}\PY{n}{TH}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{n}{thb}\PY{p}{)}\PY{o}{.}\PY{n}{nonzero}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Initialize matrices}
         \PY{n}{sig} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} shear stress \PYZbs{}sigma\PYZus{}\PYZob{}r\PYZbs{}theta\PYZcb{}}
         \PY{n}{urB} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} r\PYZhy{}components of velocity}
         \PY{n}{uthB} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} th\PYZhy{}components of velocity}
         \PY{n}{urA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} r\PYZhy{}components of velocity}
         \PY{n}{uthA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} th\PYZhy{}components of velocity}
         \PY{n}{Ux} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} x\PYZhy{}components of velocity}
         \PY{n}{Uy} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} y\PYZhy{}components of velocity}
         \PY{n}{psiB} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} stream function in region B}
         \PY{n}{psiA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{R}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} stream function in region A}
         
         \PY{c+c1}{\PYZsh{} In Region B: mantle wedge}
         \PY{n}{Vcon} \PY{o}{=} \PY{n}{vslab}\PY{o}{/}\PY{p}{(}\PY{n}{thb}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{thb}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{A} \PY{o}{=} \PY{n}{Vcon}\PY{o}{*}\PY{n}{thb}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{thb}\PY{p}{)}
         \PY{n}{B} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{Vcon}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{thb}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{thb}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{thb}\PY{p}{)}\PY{p}{)}
         \PY{n}{D} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{Vcon}\PY{o}{*}\PY{n}{thb}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{thb}\PY{p}{)}
         \PY{n}{M} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{etaslabm}
         
         \PY{c+c1}{\PYZsh{} Shear stress}
         \PY{n}{sig}\PY{p}{[}\PY{n}{pb}\PY{p}{]} \PY{o}{=} \PY{n}{M}\PY{o}{*}\PY{p}{(}\PY{n}{C}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{D}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{R}\PY{p}{[}\PY{n}{pb}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} Velocity components}
         \PY{n}{urB} \PY{o}{=} \PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{+} \PY{n}{TH}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{)} 
                                                                                 \PY{o}{\PYZhy{}} \PY{n}{TH}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{)}\PY{p}{)}
         \PY{n}{uthB} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{A}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{+} \PY{n}{B}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{+} \PY{n}{C}\PY{o}{*}\PY{n}{TH}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{)} \PY{o}{+} \PY{n}{D}\PY{o}{*}\PY{n}{TH}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{)}\PY{p}{)}
         \PY{n}{psiB}\PY{p}{[}\PY{n}{pb}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{R}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{o}{*}\PY{n}{uthB}\PY{p}{[}\PY{n}{pb}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} convert to x\PYZhy{}y components}
         \PY{n}{Ux}\PY{p}{[}\PY{n}{pb}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{urB}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{uthB}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)}
         \PY{n}{Uy}\PY{p}{[}\PY{n}{pb}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{urB}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{uthB}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{TH}\PY{p}{[}\PY{n}{pb}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} In Region A: below the slab}
         \PY{n}{Vcon2} \PY{o}{=} \PY{n}{vslab}\PY{o}{/}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{tha}\PY{p}{)} \PY{o}{+} \PY{n}{tha}\PY{p}{)}
         \PY{n}{E} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{Vcon2}\PY{o}{*}\PY{n}{tha}
         \PY{n}{F} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{G} \PY{o}{=} \PY{n}{Vcon2}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{tha}\PY{p}{)}\PY{p}{)}
         \PY{n}{H} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{Vcon2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{tha}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Shear stress}
         \PY{n}{sig}\PY{p}{[}\PY{n}{pa}\PY{p}{]} \PY{o}{=} \PY{n}{M}\PY{o}{*}\PY{p}{(}\PY{n}{G}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{H}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{R}\PY{p}{[}\PY{n}{pa}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} Velocity components}
         \PY{n}{urA} \PY{o}{=} \PY{n}{E}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{F}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{+} \PY{n}{G}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{+} \PY{n}{THM}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n}{H}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{)}                                                                              \PY{o}{\PYZhy{}} \PY{n}{THM}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{)}\PY{p}{)}
         \PY{n}{uthA} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{E}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{+} \PY{n}{F}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{+} \PY{n}{G}\PY{o}{*}\PY{n}{THM}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{)} \PY{o}{+} \PY{n}{H}\PY{o}{*}\PY{n}{THM}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{)}\PY{p}{)}
         \PY{n}{psiA}\PY{p}{[}\PY{n}{pa}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{R}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{o}{*}\PY{n}{uthA}\PY{p}{[}\PY{n}{pa}\PY{p}{]}
         
         \PY{n}{Ux}\PY{p}{[}\PY{n}{pa}\PY{p}{]} \PY{o}{=} \PY{n}{urA}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{uthA}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)}
         \PY{n}{Uy}\PY{p}{[}\PY{n}{pa}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{urA}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{uthA}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{THM}\PY{p}{[}\PY{n}{pa}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{Ux} \PY{o}{=} \PY{n}{Ux}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{sec2yr}
         \PY{n}{Uy} \PY{o}{=} \PY{n}{Uy}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{sec2yr}
         \PY{c+c1}{\PYZsh{} Make figure}
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{}(figsize=(12,4), dpi=100)}
                         
         \PY{n}{axes1} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{p}{,} \PY{l+m+mf}{1.4}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} left, bottom, width, height (range 0 to 1)}
         \PY{n}{levels} \PY{o}{=} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{200}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{]}
         \PY{n}{cf} \PY{o}{=} \PY{n}{axes1}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{sig}\PY{o}{*}\PY{n}{pa2bar}\PY{p}{,}\PY{n}{levels}\PY{p}{)}
         \PY{n}{axes1}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{axes1}\PY{o}{.}\PY{n}{get\PYZus{}ylim}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{axes1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axes1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{etasmtext} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}4.2g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{etaslabm}
         \PY{n}{vtext} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}V\PYZus{}}\PY{l+s+si}{\PYZob{}slab\PYZcb{}}\PY{l+s+s1}{\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{vslabcmyr}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ cm/yr}\PY{l+s+s1}{\PYZsq{}} 
         \PY{n}{etatext} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{eta\PYZus{}}\PY{l+s+si}{\PYZob{}sm\PYZcb{}}\PY{l+s+s1}{\PYZdl{}=}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{etasmtext} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Pa s, }\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{diptext} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dip =}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{dip}\PY{p}{)}
         \PY{n}{titletext} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shear stress: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{vtext} \PY{o}{+} \PY{n}{etatext} \PY{o}{+} \PY{n}{diptext}
         \PY{n}{axes1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{titletext}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}cb = fig.colorbar(cf,ax=axes1)}
         
         \PY{n}{axes4} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{1.4}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} left, bottom, width, height (range 0 to 1)}
         \PY{n}{cf4} \PY{o}{=} \PY{n}{axes4}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{psiB}\PY{o}{*}\PY{l+m+mf}{1e5}\PY{p}{,}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{7}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{cf5} \PY{o}{=} \PY{n}{axes4}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{psiA}\PY{o}{*}\PY{l+m+mf}{1e5}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{18}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{dd} \PY{o}{=} \PY{l+m+mi}{8}
         \PY{n}{qv} \PY{o}{=} \PY{n}{axes4}\PY{o}{.}\PY{n}{quiver}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{,}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{]}\PY{p}{,}\PY{n}{Y}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{,}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{]}\PY{p}{,}\PY{n}{Ux}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{,}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{]}\PY{p}{,}\PY{n}{Uy}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{,}\PY{p}{:}\PY{p}{:}\PY{n}{dd}\PY{p}{]}\PY{p}{,}
                           \PY{n}{scale} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{scale\PYZus{}units}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{qk} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{quiverkey}\PY{p}{(}\PY{n}{qv}\PY{p}{,} \PY{l+m+mf}{1.45}\PY{p}{,} \PY{l+m+mf}{0.93}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}5 }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+si}{\PYZob{}cm\PYZcb{}}\PY{l+s+si}{\PYZob{}yr\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelpos}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                            \PY{n}{coordinates}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axes4}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{axes4}\PY{o}{.}\PY{n}{get\PYZus{}ylim}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{axes4}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flow and Streamlines}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
thb 0.7853981633974483 tha 2.356194490192345

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:} Text(0.5,1,'Flow and Streamlines')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_3_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \hypertarget{mckenzie-d.-p.-gjras-1969-pages-13-15-and-figure-7}{%
\subsubsection{McKenzie, D. P. (GJRAS, 1969), pages 13-15 and figure
7}\label{mckenzie-d.-p.-gjras-1969-pages-13-15-and-figure-7}}

 \begin{center}
    \adjustimage{max size={0.8\linewidth}{0.8\paperheight}}{mckenzie_gjras69_p13.png}
    \end{center}
   { \hspace*{\fill} \\}
    \begin{center}
    \adjustimage{max size={0.8\linewidth}{0.8\paperheight}}{mckenzie_gjras69_p14.png}
    \end{center}
   { \hspace*{\fill} \\}
    \begin{center}
    \adjustimage{max size={0.8\linewidth}{0.8\paperheight}}{mckenzie_gjras69_p15.png}
    \end{center}
   { \hspace*{\fill} \\}
    \begin{center}
    \adjustimage{max size={0.8\linewidth}{0.8\paperheight}}{mckenzie_gjras69_fig7stress.png}
    \end{center}
   { \hspace*{\fill} \\}


 % Add a bibliography block to the postdoc
 %%%%%%%%%%%%%%
\bibliographystyle{elsarticle-harv.bst}
\bibliography{/Users/billen/Library/texmf/bibtex/myref}
%%%%%%%%%%%%%%

    
    
    \end{document}
